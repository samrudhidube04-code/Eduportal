{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from '@angular/core';\nexport let EnrollCourseComponent = class EnrollCourseComponent {\n  constructor(http, router) {\n    this.http = http;\n    this.router = router;\n    this.apiUrl = 'http://localhost:3000/users';\n    this.showModal = false;\n  }\n  ngOnInit() {\n    const userData = localStorage.getItem('loggedInUser');\n    if (userData) {\n      this.user = JSON.parse(userData);\n    }\n  }\n  openModal() {\n    const userData = localStorage.getItem('loggedInUser');\n    if (!userData) {\n      alert('⚠️ Please login to enroll.');\n      this.router.navigate(['/login']);\n      return;\n    }\n    this.user = JSON.parse(userData);\n    this.showModal = true;\n  }\n  closeModal() {\n    this.showModal = false;\n  }\n  enrollCourse() {\n    this.http.get(this.apiUrl).subscribe(users => {\n      const user = users.find(u => u.email === this.user.email);\n      if (!user) {\n        alert('User not found in system.');\n        this.closeModal();\n        return;\n      }\n      if (!user.enrolledCourses) {\n        user.enrolledCourses = [];\n      }\n      const alreadyEnrolled = user.enrolledCourses.some(c => c.id === this.course.id);\n      if (alreadyEnrolled) {\n        alert('❗ You are already enrolled in this course.');\n        this.closeModal();\n        return;\n      }\n      user.enrolledCourses.push(this.course);\n      this.http.patch(`${this.apiUrl}/${user.id}`, {\n        enrolledCourses: user.enrolledCourses\n      }).subscribe(updatedUser => {\n        localStorage.setItem('loggedInUser', JSON.stringify(updatedUser));\n        alert(`✅ Enrolled in \"${this.course.name}\" successfully!`);\n        this.closeModal();\n      });\n    });\n  }\n};\n__decorate([Input()], EnrollCourseComponent.prototype, \"course\", void 0);\nEnrollCourseComponent = __decorate([Component({\n  selector: 'app-enroll-course',\n  templateUrl: './enroll-course.component.html',\n  styleUrls: ['./enroll-course.component.css']\n})], EnrollCourseComponent);","map":{"version":3,"names":["Component","Input","EnrollCourseComponent","constructor","http","router","apiUrl","showModal","ngOnInit","userData","localStorage","getItem","user","JSON","parse","openModal","alert","navigate","closeModal","enrollCourse","get","subscribe","users","find","u","email","enrolledCourses","alreadyEnrolled","some","c","id","course","push","patch","updatedUser","setItem","stringify","name","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\rocks\\OneDrive\\Desktop\\Angular\\AngularForm\\src\\app\\Components\\enroll\\enroll.component.ts"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\n\ninterface Course {\n  id: number;\n  name: string;\n  description: string;\n  price: number;\n  image: string;\n}\n\n@Component({\n  selector: 'app-enroll-course',\n  templateUrl: './enroll-course.component.html',\n  styleUrls: ['./enroll-course.component.css']\n})\nexport class EnrollCourseComponent implements OnInit {\n  @Input() course!: Course;\n  private apiUrl = 'http://localhost:3000/users';\n\n  user: any;\n  showModal: boolean = false;\n\n  constructor(private http: HttpClient, private router: Router) { }\n\n  ngOnInit(): void {\n    const userData = localStorage.getItem('loggedInUser');\n    if (userData) {\n      this.user = JSON.parse(userData);\n    }\n  }\n\n  openModal() {\n    const userData = localStorage.getItem('loggedInUser');\n    if (!userData) {\n      alert('⚠️ Please login to enroll.');\n      this.router.navigate(['/login']);\n      return;\n    }\n\n    this.user = JSON.parse(userData);\n    this.showModal = true;\n  }\n\n  closeModal() {\n    this.showModal = false;\n  }\n\n  enrollCourse() {\n    this.http.get<any[]>(this.apiUrl).subscribe(users => {\n      const user = users.find(u => u.email === this.user.email);\n\n      if (!user) {\n        alert('User not found in system.');\n        this.closeModal();\n        return;\n      }\n\n      if (!user.enrolledCourses) {\n        user.enrolledCourses = [];\n      }\n\n      const alreadyEnrolled = user.enrolledCourses.some((c: Course) => c.id === this.course.id);\n      if (alreadyEnrolled) {\n        alert('❗ You are already enrolled in this course.');\n        this.closeModal();\n        return;\n      }\n\n      user.enrolledCourses.push(this.course);\n\n      this.http.patch(`${this.apiUrl}/${user.id}`, { enrolledCourses: user.enrolledCourses })\n        .subscribe(updatedUser => {\n          localStorage.setItem('loggedInUser', JSON.stringify(updatedUser));\n          alert(`✅ Enrolled in \"${this.course.name}\" successfully!`);\n          this.closeModal();\n        });\n    });\n  }\n}\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,KAAK,QAAgB,eAAe;AAiBjD,WAAMC,qBAAqB,GAA3B,MAAMA,qBAAqB;EAOhCC,YAAoBC,IAAgB,EAAUC,MAAc;IAAxC,KAAAD,IAAI,GAAJA,IAAI;IAAsB,KAAAC,MAAM,GAANA,MAAM;IAL5C,KAAAC,MAAM,GAAG,6BAA6B;IAG9C,KAAAC,SAAS,GAAY,KAAK;EAEsC;EAEhEC,QAAQA,CAAA;IACN,MAAMC,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IACrD,IAAIF,QAAQ,EAAE;MACZ,IAAI,CAACG,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,QAAQ,CAAC;;EAEpC;EAEAM,SAASA,CAAA;IACP,MAAMN,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IACrD,IAAI,CAACF,QAAQ,EAAE;MACbO,KAAK,CAAC,4BAA4B,CAAC;MACnC,IAAI,CAACX,MAAM,CAACY,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;MAChC;;IAGF,IAAI,CAACL,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,QAAQ,CAAC;IAChC,IAAI,CAACF,SAAS,GAAG,IAAI;EACvB;EAEAW,UAAUA,CAAA;IACR,IAAI,CAACX,SAAS,GAAG,KAAK;EACxB;EAEAY,YAAYA,CAAA;IACV,IAAI,CAACf,IAAI,CAACgB,GAAG,CAAQ,IAAI,CAACd,MAAM,CAAC,CAACe,SAAS,CAACC,KAAK,IAAG;MAClD,MAAMV,IAAI,GAAGU,KAAK,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,KAAK,KAAK,IAAI,CAACb,IAAI,CAACa,KAAK,CAAC;MAEzD,IAAI,CAACb,IAAI,EAAE;QACTI,KAAK,CAAC,2BAA2B,CAAC;QAClC,IAAI,CAACE,UAAU,EAAE;QACjB;;MAGF,IAAI,CAACN,IAAI,CAACc,eAAe,EAAE;QACzBd,IAAI,CAACc,eAAe,GAAG,EAAE;;MAG3B,MAAMC,eAAe,GAAGf,IAAI,CAACc,eAAe,CAACE,IAAI,CAAEC,CAAS,IAAKA,CAAC,CAACC,EAAE,KAAK,IAAI,CAACC,MAAM,CAACD,EAAE,CAAC;MACzF,IAAIH,eAAe,EAAE;QACnBX,KAAK,CAAC,4CAA4C,CAAC;QACnD,IAAI,CAACE,UAAU,EAAE;QACjB;;MAGFN,IAAI,CAACc,eAAe,CAACM,IAAI,CAAC,IAAI,CAACD,MAAM,CAAC;MAEtC,IAAI,CAAC3B,IAAI,CAAC6B,KAAK,CAAC,GAAG,IAAI,CAAC3B,MAAM,IAAIM,IAAI,CAACkB,EAAE,EAAE,EAAE;QAAEJ,eAAe,EAAEd,IAAI,CAACc;MAAe,CAAE,CAAC,CACpFL,SAAS,CAACa,WAAW,IAAG;QACvBxB,YAAY,CAACyB,OAAO,CAAC,cAAc,EAAEtB,IAAI,CAACuB,SAAS,CAACF,WAAW,CAAC,CAAC;QACjElB,KAAK,CAAC,kBAAkB,IAAI,CAACe,MAAM,CAACM,IAAI,iBAAiB,CAAC;QAC1D,IAAI,CAACnB,UAAU,EAAE;MACnB,CAAC,CAAC;IACN,CAAC,CAAC;EACJ;CACD;AA9DUoB,UAAA,EAARrC,KAAK,EAAE,C,oDAAiB;AADdC,qBAAqB,GAAAoC,UAAA,EALjCtC,SAAS,CAAC;EACTuC,QAAQ,EAAE,mBAAmB;EAC7BC,WAAW,EAAE,gCAAgC;EAC7CC,SAAS,EAAE,CAAC,+BAA+B;CAC5C,CAAC,C,EACWvC,qBAAqB,CA+DjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}